---
import SocialLinks from "./SocialLinks.astro";

const links = [
  { href: "/", label: "Home" },
  { href: "/about", label: "About" },
  { href: "/projects", label: "Projects" },
  { href: "/publications", label: "Publications" },
];

const base = import.meta.env.BASE_URL;
const basePath = base.endsWith("/") ? base : `${base}/`;
const withBase = (path: string) => `${basePath}${path.replace(/^\/+/, "")}`;
const normalizePath = (path: string) => (path.replace(/\/+$/, "") || "/");
const stripBase = (path: string) =>
  path.startsWith(basePath) ? `/${path.slice(basePath.length)}` : path;
const currentPath = normalizePath(stripBase(Astro.url.pathname));
---

<nav class="mb-12 flex flex-wrap items-center justify-between gap-4 border-b border-slate-200 pb-4 font-sans">
  <div class="flex gap-6">
    {links.map((link) => {
      const linkPath = normalizePath(link.href);
      const isActive =
        linkPath === "/"
          ? currentPath === "/"
          : currentPath.startsWith(linkPath);

      return (
        <a
          href={withBase(link.href)}
          aria-current={isActive ? "page" : undefined}
          class={[
            "pb-1",
            isActive
              ? "border-b-2 border-slate-900 text-slate-900"
              : "text-slate-600 hover:text-indigo-600",
          ].join(" ")}
        >
          {link.label}
        </a>
      );
    })}
  </div>

  <SocialLinks />
</nav>
